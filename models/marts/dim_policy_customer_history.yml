version: 1
models:
- name: dim_policy_customer_history
  description: This model tracks the historical changes of customer policies, capturing
    each version of a policy with its effective and valid time periods. It is used
    to analyze policy changes over time and identify the current active policy for
    each customer.
  columns:
  - name: policy_id
    description: A unique identifier for each policy.
    data_tests:
      - not_null
  - name: customer_id
    description: A unique identifier for each customer.
    data_tests:
      - not_null
  - name: customer_name
    description: The name of the customer associated with the policy.
  - name: state
    description: The state where the customer resides.
  - name: dob
    description: The date of birth of the customer.
  - name: policy_type
    description: The type of policy held by the customer.
  - name: premium_amount
    description: The amount of premium to be paid for the policy.
  - name: effective_date
    description: The date when the policy becomes effective.
  - name: valid_from
    description: The start date from which the policy version is valid.
    data_tests:
      - not_null
  - name: valid_to
    description: The end date until which the policy version is valid.
  - name: record_checksum
    description: A checksum value for ensuring data integrity of the record.
  - name: is_current
    description: Indicates whether the policy version is the current active version.